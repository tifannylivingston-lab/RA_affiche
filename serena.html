<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Serena Williams â€“ RA (Hologram)</title>

<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
body {
  margin: 0;
  overflow: hidden;
  background: black;
  font-family: Arial, Helvetica, sans-serif;
}
</style>
</head>

<body>

<a-scene
  mindar-image="imageTargetSrc: serena.mind;"
  vr-mode-ui="enabled:false"
  device-orientation-permission-ui="enabled:true">

  <a-camera look-controls="false"></a-camera>

  <a-assets>
    <video id="video-serena"
      src="serena.mp4"
      preload="auto"
      playsinline
      muted>
    </video>
  </a-assets>

  <a-entity id="target" mindar-image-target="targetIndex:0">

    <!-- VIDEO -->
    <a-plane id="videoPlane"
      material="shader: flat; src: #video-serena"
      visible="false">
    </a-plane>

    <!-- HOLOGRAMME -->
    <a-entity id="hologram" visible="false">

      <!-- Anneau lumineux -->
      <a-ring position="0 0 0"
              radius-inner="0.7" radius-outer="0.75"
              color="#FF2EB3" 
              material="shader: flat; opacity:0.6">
      </a-ring>

      <!-- Stats flottantes sur le cercle -->
      <a-entity id="stats">

        <a-text id="stat1" value="ðŸŽ¾ 23" position="0.7 0 0" align="center" color="#FFFFFF"></a-text>
        <a-text id="stat2" value="ðŸ¥‡ 4" position="-0.35 0.6 0" align="center" color="#FFFFFF"></a-text>
        <a-text id="stat3" value="ðŸ‘‘ 319" position="-0.35 -0.6 0" align="center" color="#FFFFFF"></a-text>

      </a-entity>

    </a-entity>

  </a-entity>
</a-scene>

<script>
const video = document.querySelector('#video-serena');
const videoPlane = document.querySelector('#videoPlane');
const hologram = document.querySelector('#hologram');
const stats = document.querySelector('#stats');
const target = document.querySelector('#target');

// Ajuster ratio vidÃ©o
video.addEventListener('loadedmetadata', () => {
  const r = video.videoWidth / video.videoHeight;
  const h = 1.6;
  videoPlane.setAttribute(
    'geometry',
    `primitive: plane; width:${h*r}; height:${h}`
  );
});

// DÃ©tection image
target.addEventListener('targetFound', () => {
  hologram.setAttribute('visible','false');
  videoPlane.setAttribute('visible','true');
  video.currentTime = 0;
  video.play();
});

// Fin vidÃ©o â†’ hologramme
video.addEventListener('ended', () => {
  videoPlane.setAttribute('visible','false');
  hologram.setAttribute('visible','true');

  // Animation rotation continue du cercle + stats
  stats.setAttribute('animation__rotate',
    'property: rotation; from:0 0 0; to:0 360 0; dur:6000; easing:linear; loop:true');

  hologram.setAttribute('animation__scale',
    'property: scale; from:0 0 0; to:1 1 1; dur:800; easing:easeOutBack');
});
</script>

</body>
</html>
