<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Serena Williams – RA</title>

<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
body { margin: 0; overflow: hidden; background: black; }
</style>
</head>

<body>

<a-scene
  mindar-image="imageTargetSrc: serena.mind;"
  vr-mode-ui="enabled:false"
  device-orientation-permission-ui="enabled:true">

  <a-camera look-controls="false"></a-camera>

  <a-assets>
    <video
      id="video-serena"
      src="serena.mp4"
      preload="auto"
      playsinline
      crossorigin="anonymous">
    </video>
  </a-assets>

  <a-entity id="target" mindar-image-target="targetIndex:0">

    <!-- VIDEO CENTRÉE -->
    <a-entity id="videoWrapper" position="0 0 0" visible="false">
      <a-plane
        id="videoPlane"
        material="shader: flat; src: #video-serena"
        geometry="primitive: plane; width: 1; height: 1"
        position="0 0 0">
      </a-plane>
    </a-entity>

    <!-- PALMARES SOBRE -->
    <a-entity id="palmares" visible="false">
      <a-plane
        width="2.8"
        height="1.6"
        color="#000"
        opacity="0.65"
        position="0 0 0">
      </a-plane>

      <a-text
        value="Serena Williams"
        position="0 0.5 0.01"
        align="center"
        width="3"
        color="#FFD700">
      </a-text>

      <a-text
        class="item"
        value="23 titres du Grand Chelem"
        position="0 0.15 0.01"
        align="center"
        width="2.6"
        color="#FFFFFF">
      </a-text>

      <a-text
        class="item"
        value="4 médailles d’or olympiques"
        position="0 -0.1 0.01"
        align="center"
        width="2.6"
        color="#FFFFFF">
      </a-text>

      <a-text
        class="item"
        value="319 semaines n°1 mondiale"
        position="0 -0.35 0.01"
        align="center"
        width="2.6"
        color="#FFFFFF">
      </a-text>

    </a-entity>

  </a-entity>
</a-scene>

<script>
const video = document.querySelector('#video-serena');
const videoPlane = document.querySelector('#videoPlane');
const videoWrapper = document.querySelector('#videoWrapper');
const palmares = document.querySelector('#palmares');
const target = document.querySelector('#target');

// Ajustement ratio et agrandissement
video.addEventListener('loadedmetadata', () => {
  const ratio = video.videoWidth / video.videoHeight;
  const height = 1.6; // hauteur finale
  const width = height * ratio;

  videoPlane.setAttribute('geometry', `primitive: plane; width: ${width}; height: ${height}`);
  videoWrapper.setAttribute('position', '0 0 0'); // centré exactement
});

// Scan image → vidéo
target.addEventListener('targetFound', () => {
  palmares.setAttribute('visible', 'false');
  videoWrapper.setAttribute('visible', 'true');
  video.currentTime = 0;
  video.play();
});

// Fin vidéo → palmarès
video.addEventListener('ended', () => {
  videoWrapper.setAttribute('visible', 'false');
  palmares.setAttribute('visible', 'true');

  document.querySelectorAll('.item').forEach((el, i) => {
    el.setAttribute(
      'animation',
      `property: opacity; from: 0; to: 1; dur: 600; delay: ${i * 300}`
    );
  });
});
</script>

</body>
</html>
